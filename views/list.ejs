<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Bootstrap 101 Template</title>

    <!-- Bootstrap -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@3.4.1/dist/css/bootstrap.min.css"
      integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu"
      crossorigin="anonymous"
    />

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
    <![endif]-->
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <link rel="stylesheet" href="/style.css" />
  </head>
  <body>
    <main>
      <div class="tododb">
        <h1>To do List</h1>

        <div class="d-flex" ;>
          <input
            class="form-control me-2"
            placeholder="Search"
            id="search-input"
          />
          <button class="btn btn-outline-success" id="search">Search</button>
        </div>
        <script>
          $('#search').click(function () {
            var 입력한값 = $('#search-input').val();
            window.location.replace('/search?value=' + 입력한값);
          });
        </script>
        <% for (i=0; i < posts.length; i++){ %>
        <div class="todolist">
          <h4><%= posts[i].title %></h4>
          <p><%= posts[i].content %></p>
          <p><%= posts[i].date %></p>

          <button class="detail">
            <a href="/detail/<%= posts[i]._id %>"> Detail</a>
          </button>
          <button class="edit" data-id="<%= posts[i]._id %>">
            <a href="/edit/<%= posts[i]._id %>"> Edit</a>
          </button>
          <button
            style="cursor: pointer"
            class="delete"
            data-id="<%= posts[i]._id %>"
          >
            Delete
          </button>
        </div>

        <% } %>
      </div>
    </main>

    <script>
      $('.delete').click((e) => {
        let post_id = e.target.dataset.id;
        let target = $(this);
        $.ajax({
          method: 'DELETE',
          url: '/delete',
          data: { _id: post_id },
        })
          .done((res) => {
            window.location.reload();
          })
          .fail(() => {});
      });
    </script>

    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
